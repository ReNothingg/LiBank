{% extends "base.html" %}
{% set page = "account" %}
{% block extra_libs %}
<script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
{% endblock %}
{% block content %}
<div class="screen">
    <header class="topbar">
        <div class="topbar-row">
            <div class="hello">
                –ü—Ä–∏–≤–µ—Ç, <span id="username">...</span>
            </div>
            <button id="logoutBtn" class="icon-btn" title="–í—ã—Ö–æ–¥" aria-label="–í—ã—Ö–æ–¥">
                <svg width="22" height="22" viewBox="0 0 24 24" fill="none">
                    <path d="M10 17l5-5-5-5" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round" />
                    <path d="M15 12H3" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                    <path d="M21 21V3" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                </svg>
            </button>
        </div>
        <div class="balance">
            <div class="balance-label">–ë–∞–ª–∞–Ω—Å</div>
            <div id="balance" class="balance-value">‚Äî</div>
        </div>
    </header>

    <section class="actions">
        <button id="scanBtn" class="btn secondary">
            <span class="emoji">üì∑</span> –°–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å QR‚Äë–∫–æ–¥
        </button>
        <button id="createBtn" class="btn primary">
            <span class="emoji">üßæ</span> –°–æ–∑–¥–∞—Ç—å QR‚Äë–∫–æ–¥
        </button>
    </section>

    <section class="history">
        <div class="history-head">
            <h2>–ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π</h2>
            <div class="filters" role="tablist">
                <button class="chip active" data-filter="all">–í—Å–µ</button>
                <button class="chip" data-filter="out">–°–ø–∏—Å–∞–Ω–∏—è</button>
                <button class="chip" data-filter="in">–ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è</button>
            </div>
        </div>
        <div id="txList" class="tx-list"></div>
    </section>
</div>

<div id="scanModal" class="modal">
    <div class="modal__sheet">
        <div class="modal__header">
            <div class="title">–û–ø–ª–∞—Ç–∞ –ø–æ QR</div>
            <button class="icon-btn" data-close-modal>&#10005;</button>
        </div>
        <div class="modal__content">
            <div id="qrReader" class="qr-reader"></div>
            <div class="muted small mt-8">–ù–∞–≤–µ–¥–∏—Ç–µ –∫–∞–º–µ—Ä—É –Ω–∞ QR‚Äë–∫–æ–¥ –∏–ª–∏ –≤—Å—Ç–∞–≤—å—Ç–µ —Å—Å—ã–ª–∫—É –≤—Ä—É—á–Ω—É—é –Ω–∏–∂–µ.</div>
            <div class="or">–∏–ª–∏</div>
            <div class="form compact">
                <input type="text" id="manualPaylink"
                    placeholder="–í—Å—Ç–∞–≤—å—Ç–µ —Å—Å—ã–ª–∫—É —Å—á—ë—Ç–∞ (http://localhost:5000/paylink?...)" />
                <button id="manualPreviewBtn" class="btn secondary">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
            </div>
            <div id="invoicePreview" class="invoice-preview hidden"></div>
        </div>
        <div class="modal__footer">
            <button class="btn ghost" data-close-modal>–û—Ç–º–µ–Ω–∞</button>
            <button id="confirmPayBtn" class="btn primary" disabled>–û–ø–ª–∞—Ç–∏—Ç—å</button>
        </div>
    </div>
</div>

<div id="createModal" class="modal">
    <div class="modal__sheet">
        <div class="modal__header">
            <div class="title">–°–æ–∑–¥–∞—Ç—å QR‚Äë—Å—á—ë—Ç</div>
            <button class="icon-btn" data-close-modal>&#10005;</button>
        </div>
        <div class="modal__content">
            <form id="createForm" class="form">
                <label class="field">
                    <span>–°—É–º–º–∞</span>
                    <input type="text" name="amount" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä, 350" inputmode="decimal" required />
                </label>
                <label class="field">
                    <span>–û–ø–∏—Å–∞–Ω–∏–µ</span>
                    <input type="text" name="description" placeholder="–ó–∞ –∫–æ—Ñ–µ" maxlength="200" />
                </label>
                <button type="submit" class="btn primary full">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å</button>
            </form>

            <div id="qrResult" class="qr-result hidden">
                <img id="qrImage" alt="QR" />
                <div class="muted small">–°—Å—ã–ª–∫–∞ –Ω–∞ –æ–ø–ª–∞—Ç—É:</div>
                <div class="copy-row">
                    <input id="qrLink" class="copy-input" readonly />
                    <button id="copyLinkBtn" class="btn secondary">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                </div>
                <button id="shareBtn" class="btn ghost full">–ü–æ–¥–µ–ª–∏—Ç—å—Å—è</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}